# Manual Penetration Testing Checklist

**Document Version:** 1.0
**Date:** 2025-10-02
**Purpose:** Comprehensive manual security testing for Sprint 1 Week 1 fixes
**Target:** SimplePro-v3 API and Infrastructure

---

## How to Use This Checklist

1. **Prerequisites:** Ensure all tools are installed and environment is configured
2. **Execution:** Work through each section systematically
3. **Documentation:** Mark each test as Pass/Fail and note findings
4. **Evidence:** Take screenshots and save command outputs
5. **Reporting:** Compile all findings into penetration test report

**Status Legend:**
- â¬œ Not Started
- ðŸ”„ In Progress
- âœ… Passed
- âŒ Failed
- âš ï¸ Warning/Partial
- â­ï¸ Skipped (with reason)

---

## Section 1: Environment Preparation

### 1.1 Tools Installation

| Tool | Purpose | Status | Notes |
|------|---------|--------|-------|
| curl | API testing | â¬œ | Version: |
| wscat | WebSocket testing | â¬œ | `npm install -g wscat` |
| jq | JSON parsing | â¬œ | For Linux/Mac |
| Burp Suite Community | Proxy/Scanner | â¬œ | Optional |
| OWASP ZAP | Vulnerability scanning | â¬œ | Optional |
| Postman | API testing | â¬œ | Optional |
| Docker Desktop | Infrastructure | â¬œ | Required |
| Node.js | Runtime | â¬œ | Version >= 20.0.0 |

### 1.2 Environment Setup

| Task | Status | Notes |
|------|--------|-------|
| Start Docker infrastructure (`npm run docker:dev`) | â¬œ | |
| Verify MongoDB running (port 27017) | â¬œ | |
| Verify Redis running (port 6379) | â¬œ | |
| Verify MinIO running (ports 9000, 9001) | â¬œ | |
| Start API server (`npm run dev:api`) | â¬œ | |
| Verify API health (`curl http://localhost:3001/api/health`) | â¬œ | |
| Seed test data (`npm run seed:dev`) | â¬œ | |
| Obtain admin JWT token | â¬œ | Save for later use |
| Obtain regular user JWT token | â¬œ | Save for later use |

### 1.3 Test Data Preparation

| Item | Status | Value/Notes |
|------|--------|-------------|
| Admin credentials | â¬œ | admin / Admin123! |
| Test user 1 credentials | â¬œ | testuser1 / Test123! |
| Test user 2 credentials | â¬œ | testuser2 / Test123! |
| Valid shared document token | â¬œ | Create via API |
| Expired shared document token | â¬œ | Create and wait/modify DB |
| Test customer ID | â¬œ | Create via API |
| Test job ID | â¬œ | Create via API |

---

## Section 2: Critical Vulnerability Validation

### 2.1 Hardcoded Secrets Testing

#### 2.1.1 Source Code Scanning

| Test | Command | Expected Result | Status | Evidence |
|------|---------|-----------------|--------|----------|
| Search for "simplepro_dev" | `grep -r "simplepro_dev" . --include="*.yml"` | No matches | â¬œ | Screenshot: |
| Search for "simplepro_redis" | `grep -r "simplepro_redis" . --include="*.yml"` | No matches | â¬œ | Screenshot: |
| Search for "simplepro_minio" | `grep -r "simplepro_minio" . --include="*.yml"` | No matches | â¬œ | Screenshot: |
| Check for fallback patterns | `grep -r '\${.*:-' docker-compose.dev.yml` | No matches | â¬œ | Screenshot: |
| Verify .env.docker.example | `cat .env.docker.example` | Contains guidance, no secrets | â¬œ | Screenshot: |

**Findings:**
```
[Record any issues found here]
```

---

#### 2.1.2 Docker Startup Without Credentials

| Test Step | Command | Expected Result | Status | Notes |
|-----------|---------|-----------------|--------|-------|
| Remove .env.docker | `rm .env.docker` | File removed | â¬œ | |
| Attempt Docker startup | `docker-compose -f docker-compose.dev.yml up` | Fails with error | â¬œ | |
| Check error message | Review output | Indicates missing vars | â¬œ | |
| Verify no containers | `docker ps \| grep simplepro` | No containers running | â¬œ | |
| Check logs | `docker-compose logs` | Shows config error | â¬œ | |

**Evidence Required:**
- Screenshot of startup failure
- Error message showing missing variables
- Empty `docker ps` output

**Findings:**
```
[Record findings here]
```

---

#### 2.1.3 Weak Password Testing

| Test Case | Password | Action | Expected Result | Status | Notes |
|-----------|----------|--------|-----------------|--------|-------|
| Empty password | "" | Start MongoDB | Fail or warning | â¬œ | |
| Simple password | "password" | Start MongoDB | Fail or warning | â¬œ | |
| Short password | "12345" | Start MongoDB | Fail or warning | â¬œ | |
| Default password | "admin" | Start MongoDB | Fail or warning | â¬œ | |
| Strong password | Generated 32-char | Start MongoDB | Success | â¬œ | |

**Password Generation Test:**
```bash
# Linux/Mac
openssl rand -base64 32

# Windows PowerShell
-join ((48..57) + (65..90) + (97..122) | Get-Random -Count 32 | ForEach-Object {[char]$_})
```

**Findings:**
```
[Record findings here]
```

---

### 2.2 JWT Secret Security Testing

#### 2.2.1 JWT Configuration Validation

| Test | Method | Expected Result | Status | Evidence |
|------|--------|-----------------|--------|----------|
| Check partner-jwt.strategy.ts | Code review | No weak fallbacks | â¬œ | Line numbers: |
| Check for 'default-secret-key' | `grep -r "default-secret-key"` | No matches in active code | â¬œ | Screenshot: |
| Verify length validation | Code review | Checks for >= 32 chars | â¬œ | Line numbers: |
| Check error messages | Code review | Clear, non-leaking | â¬œ | Screenshot: |

**Findings:**
```
[Record findings here]
```

---

#### 2.2.2 Token Forgery Attempts

| Attack | Payload | Command | Expected Result | Status | Notes |
|--------|---------|---------|-----------------|--------|-------|
| None algorithm | See below | `curl -X GET ... -H "Authorization: Bearer TOKEN"` | 401 Unauthorized | â¬œ | |
| Weak signature | See below | Same as above | 401 Unauthorized | â¬œ | |
| Malformed token | `not.a.token` | Same as above | 401 Unauthorized | â¬œ | |
| Empty token | `""` | Same as above | 401 Unauthorized | â¬œ | |
| Missing Bearer | `Authorization: TOKEN` | Same as above | 401 Unauthorized | â¬œ | |

**Token Payloads:**
```bash
# None algorithm token
NONE_TOKEN="eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJ1c2VySWQiOiJhZG1pbiIsInJvbGUiOiJhZG1pbiJ9."

# Test
curl -X GET http://localhost:3001/api/users/me \
  -H "Authorization: Bearer $NONE_TOKEN"

# Expected: 401 Unauthorized
```

**Findings:**
```
[Record all token forgery attempts and results]
```

---

#### 2.2.3 Valid Token Testing

| Test | Command | Expected Result | Status | Notes |
|------|---------|-----------------|--------|-------|
| Login as admin | `curl -X POST .../auth/login -d '{"username":"admin","password":"Admin123!"}'` | Returns tokens | â¬œ | |
| Use access token | `curl -X GET .../users/me -H "Authorization: Bearer TOKEN"` | 200 OK, user data | â¬œ | |
| Expired token | Wait 1+ hours or modify | 401 Unauthorized | â¬œ | |
| Refresh token flow | `curl -X POST .../auth/refresh -d '{"refreshToken":"..."}'` | New access token | â¬œ | |

**Findings:**
```
[Record findings here]
```

---

### 2.3 Document Sharing Security Testing

#### 2.3.1 HTTP Method Testing

| Test | Method | URL Pattern | Expected Result | Status | Notes |
|------|--------|-------------|-----------------|--------|-------|
| GET with password in URL | GET | `/shared/:token/access?password=X` | 404 or 405 | â¬œ | |
| GET without password | GET | `/shared/:token/access` | 404 or 405 | â¬œ | |
| POST with password in body | POST | `/shared/:token/access` + body | Accepted (400/401 for invalid) | â¬œ | |
| PUT method | PUT | `/shared/:token/access` | 404 or 405 | â¬œ | |
| DELETE method | DELETE | `/shared/:token/access` | 404 or 405 | â¬œ | |

**Test Commands:**
```bash
# GET with password (SHOULD FAIL)
curl -X GET "http://localhost:3001/api/documents/shared/test-token/access?password=test" \
  -v

# POST with password in body (CORRECT METHOD)
curl -X POST http://localhost:3001/api/documents/shared/test-token/access \
  -H "Content-Type: application/json" \
  -d '{"password":"test"}' \
  -v
```

**Evidence Required:**
- Screenshot showing GET returns 404/405
- Screenshot showing POST is accepted (even if token invalid)

**Findings:**
```
[Record findings here]
```

---

#### 2.3.2 Rate Limiting Testing

| Attempt | Password | Expected Status | Actual Status | Notes |
|---------|----------|-----------------|---------------|-------|
| 1 | wrong1 | 401 | â¬œ | |
| 2 | wrong2 | 401 | â¬œ | |
| 3 | wrong3 | 401 | â¬œ | |
| 4 | wrong4 | 401 | â¬œ | |
| 5 | wrong5 | 401 | â¬œ | |
| 6 | wrong6 | 429 | â¬œ | Rate limit should trigger |

**Test Script:**
```bash
#!/bin/bash
TOKEN="test-token-123"

for i in {1..6}; do
  echo "=== Attempt $i ==="
  curl -X POST http://localhost:3001/api/documents/shared/$TOKEN/access \
    -H "Content-Type: application/json" \
    -d "{\"password\":\"wrong$i\"}" \
    -w "\nHTTP Status: %{http_code}\n" \
    -s
  echo "---"
  sleep 0.5
done
```

**Verification Points:**
- âœ… First 5 attempts return 401 (wrong password)
- âœ… 6th attempt returns 429 (rate limited)
- âœ… Response includes retry-after header
- âœ… Rate limit persists for 1 hour
- âœ… Different IP can make separate attempts

**Evidence Required:**
- Screenshot of all 6 attempts
- Screenshot of 429 response with headers
- Log showing rate limit enforcement

**Findings:**
```
[Record findings here]
```

---

#### 2.3.3 Rate Limit Bypass Attempts

| Bypass Technique | Test Method | Expected Result | Status | Notes |
|------------------|-------------|-----------------|--------|-------|
| X-Forwarded-For spoofing | Add header with fake IP | Rate limit still applies | â¬œ | |
| X-Real-IP spoofing | Add header with fake IP | Rate limit still applies | â¬œ | |
| User-Agent rotation | Change UA per request | Rate limit still applies | â¬œ | |
| Different port | Connect via different port | Rate limit still applies | â¬œ | |
| Session/cookie manipulation | Change cookies | Rate limit still applies | â¬œ | |

**Test Commands:**
```bash
# Attempt IP spoofing
for i in {1..6}; do
  curl -X POST http://localhost:3001/api/documents/shared/TOKEN/access \
    -H "X-Forwarded-For: 1.2.3.$i" \
    -H "Content-Type: application/json" \
    -d '{"password":"wrong"}' \
    -w "Status: %{http_code}\n"
done
# Expected: Still rate limited on 6th attempt
```

**Findings:**
```
[Record findings here]
```

---

#### 2.3.4 Password Exposure Testing

| Check Location | Method | Finding | Status | Notes |
|----------------|--------|---------|--------|-------|
| Response headers | Inspect headers | No password | â¬œ | |
| Response body | Inspect body | No password | â¬œ | |
| Server access logs | `tail -f logs/access.log` | No password | â¬œ | |
| Application logs | `tail -f logs/app.log` | No password | â¬œ | |
| Browser history | Check URL history | No password | â¬œ | |
| Proxy logs (if using) | Check Burp/ZAP | No password | â¬œ | |

**Test Command:**
```bash
# Make request with test password
curl -X POST http://localhost:3001/api/documents/shared/TOKEN/access \
  -H "Content-Type: application/json" \
  -d '{"password":"TESTPASSWORD123"}' \
  -v 2>&1 | tee request-output.txt

# Check if password appears in output
grep -i "TESTPASSWORD123" request-output.txt

# Check server logs
grep -i "TESTPASSWORD123" apps/api/logs/*.log
```

**Expected:** No matches for password in any logs

**Evidence Required:**
- Screenshot of response headers
- Screenshot of application logs
- Screenshot of access logs

**Findings:**
```
[Record findings here]
```

---

#### 2.3.5 Audit Log Verification

| Event Type | Log Entry Expected | Found | Status | Notes |
|------------|-------------------|-------|--------|-------|
| Valid access | Success with metadata | â¬œ | â¬œ | |
| Invalid token | Invalid token attempt | â¬œ | â¬œ | |
| Expired token | Expired link access | â¬œ | â¬œ | |
| Wrong password | Failed password attempt | â¬œ | â¬œ | |
| Rate limited | Rate limit triggered | â¬œ | â¬œ | |

**Test Method:**
```bash
# Clear logs or note timestamp
date

# Generate test events (valid access, wrong password, etc.)

# Check logs
grep "Document share" apps/api/logs/app.log | tail -20
```

**Required Log Fields:**
- Timestamp
- Event type
- IP address
- Token (not password!)
- Outcome (success/failure)
- User agent (optional)

**Findings:**
```
[Record findings here]
```

---

### 2.4 WebSocket Security Testing

#### 2.4.1 Authentication Testing

| Test | Method | Expected Result | Status | Notes |
|------|--------|-----------------|--------|-------|
| Connect without token | `wscat -c ws://localhost:3001/realtime` | Rejected immediately | â¬œ | |
| Connect with invalid token | `wscat -c ... -H "Authorization: Bearer invalid"` | Rejected immediately | â¬œ | |
| Connect with expired token | Use expired JWT | Rejected immediately | â¬œ | |
| Connect with valid token | Use valid JWT | Connected | â¬œ | |
| Connect then send without auth | Connect, don't auth, send event | Rejected | â¬œ | |

**Test Commands:**
```bash
# Test 1: No authentication
wscat -c ws://localhost:3001/realtime
# Expected: Immediate disconnect with error

# Test 2: Valid authentication
TOKEN=$(curl -s -X POST http://localhost:3001/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"Admin123!"}' \
  | jq -r '.accessToken')

wscat -c ws://localhost:3001/realtime \
  -H "Authorization: Bearer $TOKEN"
# Expected: Connection established
```

**Evidence Required:**
- Screenshot of failed connection without auth
- Screenshot of successful connection with auth
- Error messages from server

**Findings:**
```
[Record findings here]
```

---

#### 2.4.2 Connection Limit Testing

| Test Scenario | Setup | Expected Result | Status | Notes |
|---------------|-------|-----------------|--------|-------|
| 5 connections from same user | Open 5 WS with same token | All accepted | â¬œ | |
| 6th connection from same user | Open 6th WS with same token | Rejected with limit error | â¬œ | |
| Close 1, open new | Close one of 5, open new | New accepted | â¬œ | |
| 10 connections from same IP | 2 users, 5 each | All accepted | â¬œ | |
| 11th connection from same IP | Open 11th from IP | Rejected with IP limit | â¬œ | |

**Test Script:**
```bash
#!/bin/bash

# Get token
TOKEN=$(curl -s -X POST http://localhost:3001/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"testuser1","password":"Test123!"}' \
  | jq -r '.accessToken')

# Open 6 connections
for i in {1..6}; do
  echo "Opening connection $i"
  wscat -c ws://localhost:3001/realtime \
    -H "Authorization: Bearer $TOKEN" &
  PIDS[$i]=$!
  sleep 1
done

# Wait
sleep 5

# Close all
for pid in ${PIDS[@]}; do
  kill $pid 2>/dev/null
done
```

**Verification Points:**
- âœ… Connections 1-5 succeed
- âœ… Connection 6 fails with "Maximum connections per user exceeded (5/5)"
- âœ… Error message shows current/max counts
- âœ… Existing connections remain stable

**Evidence Required:**
- Screenshot of 5 successful connections
- Screenshot of 6th connection rejection
- Error message showing limit details

**Findings:**
```
[Record findings here]
```

---

#### 2.4.3 Event Rate Limiting Testing

| Test Phase | Action | Expected Result | Status | Notes |
|------------|--------|-----------------|--------|-------|
| Send 50 events | Rapid fire | All accepted | â¬œ | |
| Send 100 events | Rapid fire | All accepted | â¬œ | |
| Send 101st event | One more | Rejected with rate limit | â¬œ | |
| Wait 60 seconds | Pause | - | â¬œ | |
| Send new event | After wait | Accepted (limit reset) | â¬œ | |

**Test Method:**
```javascript
// In wscat, after connecting:

// Send 101 events
for (let i = 1; i <= 101; i++) {
  send(JSON.stringify({
    event: 'test.ping',
    data: { index: i }
  }));
}

// Watch for rate limit error on event 101
```

**Expected Error Message:**
```json
{
  "error": "Rate limit exceeded: 100 events per minute",
  "limit": 100,
  "window": 60000
}
```

**Evidence Required:**
- Screenshot showing first 100 events accepted
- Screenshot showing 101st event rejected
- Error message with rate limit details

**Findings:**
```
[Record findings here]
```

---

#### 2.4.4 DoS Attack Simulation

| Attack Type | Method | Expected Outcome | Status | Notes |
|-------------|--------|------------------|--------|-------|
| Connection flooding | Open 1000+ connections | Limits enforced, server stable | â¬œ | |
| Event flooding | Send 10000+ events | Rate limiting blocks, server stable | â¬œ | |
| Large payload | Send 10MB message | Rejected or size limited | â¬œ | |
| Rapid connect/disconnect | Loop connect/disconnect | Server remains stable | â¬œ | |
| Multiple IPs simulation | Use multiple users | IP limits enforced | â¬œ | |

**Monitor During Testing:**
```bash
# CPU usage
top -p $(pgrep -f "node.*api")

# Memory usage
watch -n 1 'ps aux | grep "node.*api" | awk "{print \$6}"'

# Connection count
watch -n 1 'netstat -an | grep ":3001" | grep ESTABLISHED | wc -l'
```

**Success Criteria:**
- CPU usage < 80%
- Memory stable (no steady increase)
- Server responds to health checks
- Legitimate connections still work

**Evidence Required:**
- Screenshot of resource usage during attack
- Screenshot of connection limits enforced
- Screenshot of server remaining healthy

**Findings:**
```
[Record findings here]
```

---

#### 2.4.5 Memory Leak Testing

| Cycle | Connections Opened | Connections Closed | Memory Before | Memory After | Leak? |
|-------|-------------------|-------------------|---------------|--------------|-------|
| 1 | 100 | 100 | â¬œ MB | â¬œ MB | â¬œ |
| 2 | 100 | 100 | â¬œ MB | â¬œ MB | â¬œ |
| 3 | 100 | 100 | â¬œ MB | â¬œ MB | â¬œ |
| 4 | 100 | 100 | â¬œ MB | â¬œ MB | â¬œ |
| 5 | 100 | 100 | â¬œ MB | â¬œ MB | â¬œ |
| 10 | 100 | 100 | â¬œ MB | â¬œ MB | â¬œ |

**Test Method:**
```bash
#!/bin/bash

for cycle in {1..10}; do
  echo "=== Cycle $cycle ==="

  # Memory before
  BEFORE=$(ps aux | grep "node.*api" | grep -v grep | awk '{print $6}')
  echo "Memory before: $BEFORE KB"

  # Open 100 connections
  for i in {1..100}; do
    wscat -c ws://localhost:3001/realtime \
      -H "Authorization: Bearer $TOKEN" &
    PIDS[$i]=$!
  done

  sleep 5

  # Close all
  for pid in ${PIDS[@]}; do
    kill $pid 2>/dev/null
  done

  sleep 5

  # Memory after
  AFTER=$(ps aux | grep "node.*api" | grep -v grep | awk '{print $6}')
  echo "Memory after: $AFTER KB"
  echo "Difference: $((AFTER - BEFORE)) KB"
  echo ""
done
```

**Analysis:**
- Calculate average memory baseline
- Check if memory steadily increases
- Verify memory returns to baseline Â± 10%

**Findings:**
```
[Record findings and memory trend analysis]
```

---

## Section 3: OWASP API Security Top 10

### API1:2023 - Broken Object Level Authorization

| Test | Scenario | Command | Expected | Status | Notes |
|------|----------|---------|----------|--------|-------|
| Access other user's document | User B tries User A's doc | GET /api/documents/:id | 403 | â¬œ | |
| Modify other user's customer | User B updates User A's customer | PATCH /api/customers/:id | 403 | â¬œ | |
| Delete other user's job | User B deletes User A's job | DELETE /api/jobs/:id | 403 | â¬œ | |
| View other user's messages | User B reads User A's messages | GET /api/messages/threads/:id | 403 | â¬œ | |

**Test Commands:**
```bash
# As User A, create a document and note the ID
TOKEN_A=...
DOC_ID=$(curl -s -X POST http://localhost:3001/api/documents/upload \
  -H "Authorization: Bearer $TOKEN_A" \
  -F "file=@test.txt" \
  | jq -r '.id')

# As User B, try to access User A's document
TOKEN_B=...
curl -X GET http://localhost:3001/api/documents/$DOC_ID \
  -H "Authorization: Bearer $TOKEN_B"

# Expected: 403 Forbidden
```

**Findings:**
```
[Record all BOLA test results]
```

---

### API2:2023 - Broken Authentication

| Attack Type | Payload | Expected Result | Status | Notes |
|-------------|---------|-----------------|--------|-------|
| Empty password | `{"username":"admin","password":""}` | 400 or 401 | â¬œ | |
| SQL injection | `{"username":"admin","password":"' OR 1=1--"}` | 401 | â¬œ | |
| NoSQL injection | `{"username":"admin","password":{"$ne":null}}` | 400 or 401 | â¬œ | |
| Long password (10000 chars) | `{"username":"admin","password":"A"*10000}` | 400 or timeout protection | â¬œ | |
| Special characters | Various special chars | Proper handling | â¬œ | |

**Findings:**
```
[Record all authentication tests]
```

---

### API3:2023 - Broken Object Property Level Authorization

| Test | Attempt | Expected Result | Status | Notes |
|------|---------|-----------------|--------|-------|
| Modify role via API | PATCH /users/me with role:admin | 403 or ignored | â¬œ | |
| Set permissions directly | PATCH /users/me with permissions array | 403 or ignored | â¬œ | |
| Modify createdAt | PATCH with createdAt in past | Ignored | â¬œ | |
| Modify _id | PATCH with different _id | Ignored | â¬œ | |

**Findings:**
```
[Record findings]
```

---

### API4:2023 - Unrestricted Resource Consumption

| Resource | Test | Expected Limit | Status | Notes |
|----------|------|----------------|--------|-------|
| API calls | 201 requests to /health | Rate limited after 200 | â¬œ | |
| File upload | Upload 100MB file | Rejected with size limit | â¬œ | |
| WebSocket events | 101 events in 1 minute | Rejected after 100 | â¬œ | |
| Request payload | POST with 10MB JSON | Rejected with size limit | â¬œ | |

**Findings:**
```
[Record findings]
```

---

### API5:2023 - Broken Function Level Authorization

| Endpoint | Role | Expected Access | Status | Notes |
|----------|------|-----------------|--------|-------|
| GET /api/admin/settings | User | 403 | â¬œ | |
| PUT /api/tariff-settings | User | 403 | â¬œ | |
| DELETE /api/users/:id | User | 403 | â¬œ | |
| GET /api/audit-logs | User | 403 | â¬œ | |
| POST /api/jobs/:id/complete | Non-crew | 403 | â¬œ | |

**Findings:**
```
[Record findings]
```

---

### API6:2023 - Unrestricted Access to Sensitive Business Flows

| Workflow | Invalid Transition | Expected Result | Status | Notes |
|----------|-------------------|-----------------|--------|-------|
| Job status | Draft â†’ Completed (skip states) | 400 or 422 | â¬œ | |
| Payment | Unpaid â†’ Refunded (invalid) | 400 or 422 | â¬œ | |
| User activation | Inactive â†’ Deleted (invalid) | 400 or 422 | â¬œ | |

**Findings:**
```
[Record findings]
```

---

### API7:2023 - Server Side Request Forgery

| Test | URL | Expected Result | Status | Notes |
|------|-----|-----------------|--------|-------|
| Internal network | http://localhost:27017 | Blocked or validated | â¬œ | |
| Cloud metadata | http://169.254.169.254 | Blocked | â¬œ | |
| File protocol | file:///etc/passwd | Blocked | â¬œ | |
| Localhost variations | http://127.0.0.1, http://[::1] | Blocked | â¬œ | |

**Findings:**
```
[Record findings]
```

---

### API8:2023 - Security Misconfiguration

| Configuration | Check | Expected State | Status | Notes |
|---------------|-------|----------------|--------|-------|
| Security headers | Check response headers | All present | â¬œ | |
| CORS | Check Access-Control headers | Restrictive | â¬œ | |
| Debug endpoints | GET /debug, /api-docs | 404 in prod | â¬œ | |
| Error messages | Trigger errors | Generic messages | â¬œ | |
| Stack traces | Trigger errors | Not exposed | â¬œ | |

**Test Commands:**
```bash
# Check security headers
curl -I http://localhost:3001/api/health

# Expected headers:
# X-Content-Type-Options: nosniff
# X-Frame-Options: DENY
# X-XSS-Protection: 1; mode=block
```

**Findings:**
```
[Record findings]
```

---

### API9:2023 - Improper Inventory Management

| Item | Check | Status | Notes |
|------|-------|--------|-------|
| API documentation current | Compare docs to code | â¬œ | |
| Deprecated endpoints disabled | Test old endpoints | â¬œ | |
| API versioning | Check /api/v1 vs /api/v2 | â¬œ | |
| Debug endpoints removed | Scan for debug routes | â¬œ | |

**Findings:**
```
[Record findings]
```

---

### API10:2023 - Unsafe Consumption of APIs

| External Service | Security Check | Status | Notes |
|------------------|---------------|--------|-------|
| Email (SMTP) | TLS enabled | â¬œ | |
| SMS (Twilio) | Credentials secured | â¬œ | |
| Storage (MinIO) | TLS enabled | â¬œ | |
| Database | Authentication required | â¬œ | |

**Findings:**
```
[Record findings]
```

---

## Section 4: Additional Security Tests

### 4.1 Session Management

| Test | Method | Expected Result | Status | Notes |
|------|--------|-----------------|--------|-------|
| Token expiration | Use token after 1 hour | 401 | â¬œ | |
| Token refresh | Use refresh token | New access token | â¬œ | |
| Concurrent sessions | Login from 2 devices | Both work | â¬œ | |
| Logout | Use token after logout | 401 | â¬œ | |
| Session fixation | Reuse old session ID | Prevented | â¬œ | |

**Findings:**
```
[Record findings]
```

---

### 4.2 Input Validation

| Attack Type | Payload | Expected Result | Status | Notes |
|-------------|---------|-----------------|--------|-------|
| XSS | `<script>alert(1)</script>` | Escaped/sanitized | â¬œ | |
| NoSQL injection | `{"$ne":null}` | Sanitized | â¬œ | |
| Path traversal | `../../etc/passwd` | Blocked | â¬œ | |
| Null bytes | `file%00.txt` | Handled | â¬œ | |
| Unicode bypass | Various unicode | Normalized | â¬œ | |

**Findings:**
```
[Record findings]
```

---

### 4.3 Error Handling

| Error Type | Trigger | Information Leaked? | Status | Notes |
|------------|---------|-------------------|--------|-------|
| Database error | Invalid MongoDB query | No DB details | â¬œ | |
| Authentication error | Wrong password | Generic message | â¬œ | |
| Authorization error | Access denied | No role/permission details | â¬œ | |
| Not found | Invalid ID | Generic 404 | â¬œ | |
| Server error | Cause exception | No stack trace | â¬œ | |

**Findings:**
```
[Record findings]
```

---

### 4.4 File Upload Security

| Test | File Type | Expected Result | Status | Notes |
|------|-----------|-----------------|--------|-------|
| Executable file | .exe, .sh | Blocked | â¬œ | |
| PHP file | .php | Blocked | â¬œ | |
| Oversized file | > 50MB | Blocked | â¬œ | |
| Malformed image | Invalid JPEG | Validated | â¬œ | |
| Null byte | file.jpg%00.php | Blocked | â¬œ | |

**Findings:**
```
[Record findings]
```

---

## Section 5: Evidence Collection

### 5.1 Screenshots Required

| Item | Filename | Status | Notes |
|------|----------|--------|-------|
| Docker startup failure | docker-startup-fail.png | â¬œ | |
| JWT token rejection | jwt-reject.png | â¬œ | |
| Rate limiting 429 | rate-limit-429.png | â¬œ | |
| WebSocket limit | ws-connection-limit.png | â¬œ | |
| Security headers | security-headers.png | â¬œ | |
| BOLA prevention | bola-403.png | â¬œ | |
| Error handling | error-generic.png | â¬œ | |

---

### 5.2 Log Files

| Log Type | Location | Collected | Status | Notes |
|----------|----------|-----------|--------|-------|
| Application logs | apps/api/logs/app.log | â¬œ | â¬œ | |
| Access logs | apps/api/logs/access.log | â¬œ | â¬œ | |
| Error logs | apps/api/logs/error.log | â¬œ | â¬œ | |
| Docker logs | docker-compose logs | â¬œ | â¬œ | |
| Audit logs | Database audit collection | â¬œ | â¬œ | |

---

### 5.3 Test Data

| Data Type | Exported | Status | Notes |
|-----------|----------|--------|-------|
| Test users created | â¬œ | â¬œ | |
| Sample requests/responses | â¬œ | â¬œ | |
| Error messages | â¬œ | â¬œ | |
| Performance metrics | â¬œ | â¬œ | |

---

## Section 6: Final Validation

### 6.1 Security Checklist Summary

| Category | Tests | Passed | Failed | Pass Rate |
|----------|-------|--------|--------|-----------|
| Hardcoded Secrets | â¬œ | â¬œ | â¬œ | â¬œ% |
| JWT Security | â¬œ | â¬œ | â¬œ | â¬œ% |
| Document Sharing | â¬œ | â¬œ | â¬œ | â¬œ% |
| WebSocket Security | â¬œ | â¬œ | â¬œ | â¬œ% |
| OWASP Top 10 | â¬œ | â¬œ | â¬œ | â¬œ% |
| Input Validation | â¬œ | â¬œ | â¬œ | â¬œ% |
| **TOTAL** | **â¬œ** | **â¬œ** | **â¬œ** | **â¬œ%** |

---

### 6.2 Critical Issues Found

| Issue # | Severity | Category | Description | Risk |
|---------|----------|----------|-------------|------|
| 1 | â¬œ | â¬œ | â¬œ | â¬œ |
| 2 | â¬œ | â¬œ | â¬œ | â¬œ |
| 3 | â¬œ | â¬œ | â¬œ | â¬œ |

---

### 6.3 Overall Assessment

**Testing Completed:** â¬œ Yes / â¬œ No

**Overall Security Posture:**
- â¬œ CRITICAL - Immediate action required
- â¬œ HIGH RISK - Address within 7 days
- â¬œ MEDIUM RISK - Address within 30 days
- â¬œ LOW RISK - Schedule for next sprint
- â¬œ SECURE - Production ready

**Recommendation:**
```
[Overall assessment and recommendation]
```

**Tester Signature:**
```
Name: ________________
Date: ________________
```

---

## Appendix A: Quick Reference Commands

### Authentication
```bash
# Get admin token
TOKEN=$(curl -s -X POST http://localhost:3001/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"Admin123!"}' \
  | jq -r '.accessToken')

# Use token
curl -X GET http://localhost:3001/api/users/me \
  -H "Authorization: Bearer $TOKEN"
```

### WebSocket
```bash
# Connect with auth
wscat -c ws://localhost:3001/realtime \
  -H "Authorization: Bearer $TOKEN"
```

### Rate Limiting
```bash
# Test document sharing rate limit
for i in {1..6}; do
  curl -X POST http://localhost:3001/api/documents/shared/TOKEN/access \
    -H "Content-Type: application/json" \
    -d "{\"password\":\"wrong$i\"}" \
    -w "Status: %{http_code}\n"
done
```

---

**Document End**
